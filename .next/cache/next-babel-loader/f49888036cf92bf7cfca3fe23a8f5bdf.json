{"ast":null,"code":"import { GoogleSpreadsheet } from 'google-spreadsheet';\nimport credentials from '../../credentials.json';\nconst doc = new GoogleSpreadsheet('1RS3tQeiyuF9S25VHOLdkuCCMR8vQncxEuyXYg20wE-M');\nexport default (async (req, res) => {\n  try {\n    await doc.useServiceAccountAuth(credentials);\n    await doc.loadInfo();\n    const sheet = doc.sheetsByIndex[2];\n    const data = JSON.parse(req.body);\n    const sheetConfig = doc.sheetsByIndex[1];\n    await sheetConfig.loadCells('A3:B3');\n    const celpromo = sheet.getCell(2, 0);\n    const celltexto = sheet.getCell(2, 1);\n    let cupon = '';\n    let promo = '';\n\n    if (cellpromo.value === 'VERDADEIRO') {\n      Cupom = 'ok';\n      Promo = celltexto.value;\n    }\n\n    await sheet.addRow({\n      Nome: data.Nome,\n      Email: data.Email,\n      Whatsapp: data.Whatsapp,\n      Cupom,\n      Promo\n    });\n    res.end(req.body);\n  } catch (err) {\n    res.end('error');\n  }\n}); //JSON.parse transforma para objeto","map":{"version":3,"sources":["H:/Projetos/palpit-box/pages/api/save.js"],"names":["GoogleSpreadsheet","credentials","doc","req","res","useServiceAccountAuth","loadInfo","sheet","sheetsByIndex","data","JSON","parse","body","sheetConfig","loadCells","celpromo","getCell","celltexto","cupon","promo","cellpromo","value","Cupom","Promo","addRow","Nome","Email","Whatsapp","end","err"],"mappings":"AAAA,SAAQA,iBAAR,QAAgC,oBAAhC;AAEA,OAAOC,WAAP,MAAwB,wBAAxB;AAEA,MAAMC,GAAG,GAAE,IAAIF,iBAAJ,CAAsB,8CAAtB,CAAX;AAEA,gBAAe,OAAMG,GAAN,EAAUC,GAAV,KAAiB;AAC5B,MAAG;AACC,UAAMF,GAAG,CAACG,qBAAJ,CAA0BJ,WAA1B,CAAN;AACA,UAAMC,GAAG,CAACI,QAAJ,EAAN;AACA,UAAMC,KAAK,GAAEL,GAAG,CAACM,aAAJ,CAAkB,CAAlB,CAAb;AACA,UAAMC,IAAI,GAAEC,IAAI,CAACC,KAAL,CAAWR,GAAG,CAACS,IAAf,CAAZ;AAEA,UAAMC,WAAW,GAAGX,GAAG,CAACM,aAAJ,CAAkB,CAAlB,CAApB;AACA,UAAMK,WAAW,CAACC,SAAZ,CAAsB,OAAtB,CAAN;AAEA,UAAMC,QAAQ,GAAGR,KAAK,CAACS,OAAN,CAAc,CAAd,EAAiB,CAAjB,CAAjB;AACA,UAAMC,SAAS,GAAGV,KAAK,CAACS,OAAN,CAAc,CAAd,EAAgB,CAAhB,CAAlB;AACA,QAAIE,KAAK,GAAE,EAAX;AACA,QAAIC,KAAK,GAAE,EAAX;;AACA,QAAIC,SAAS,CAACC,KAAV,KAAoB,YAAxB,EAAqC;AACjCC,MAAAA,KAAK,GAAG,IAAR;AACAC,MAAAA,KAAK,GAAGN,SAAS,CAACI,KAAlB;AACH;;AAED,UAAMd,KAAK,CAACiB,MAAN,CAAa;AACfC,MAAAA,IAAI,EAAEhB,IAAI,CAACgB,IADI;AAEfC,MAAAA,KAAK,EAAEjB,IAAI,CAACiB,KAFG;AAGfC,MAAAA,QAAQ,EAAClB,IAAI,CAACkB,QAHC;AAIfL,MAAAA,KAJe;AAKfC,MAAAA;AALe,KAAb,CAAN;AAOAnB,IAAAA,GAAG,CAACwB,GAAJ,CAAQzB,GAAG,CAACS,IAAZ;AACH,GA1BD,CA0BC,OAAMiB,GAAN,EAAU;AACPzB,IAAAA,GAAG,CAACwB,GAAJ,CAAQ,OAAR;AACH;AACJ,CA9BD,E,CAiCA","sourcesContent":["import {GoogleSpreadsheet} from 'google-spreadsheet'\r\n\r\nimport credentials from '../../credentials.json'\r\n\r\nconst doc= new GoogleSpreadsheet('1RS3tQeiyuF9S25VHOLdkuCCMR8vQncxEuyXYg20wE-M')\r\n\r\nexport default async(req,res) =>{\r\n    try{\r\n        await doc.useServiceAccountAuth(credentials)\r\n        await doc.loadInfo()\r\n        const sheet =doc.sheetsByIndex[2]\r\n        const data =JSON.parse(req.body)\r\n\r\n        const sheetConfig = doc.sheetsByIndex[1]\r\n        await sheetConfig.loadCells('A3:B3')\r\n\r\n        const celpromo = sheet.getCell(2 ,0)       \r\n        const celltexto = sheet.getCell(2,1)\r\n        let cupon= ''\r\n        let promo= ''\r\n        if (cellpromo.value === 'VERDADEIRO'){\r\n            Cupom = 'ok'\r\n            Promo = celltexto.value\r\n        }\r\n\r\n        await sheet.addRow({\r\n            Nome :data.Nome,\r\n            Email: data.Email,\r\n            Whatsapp:data.Whatsapp,\r\n            Cupom,\r\n            Promo\r\n        })        \r\n        res.end(req.body)\r\n    }catch(err){\r\n        res.end('error')\r\n    }\r\n}\r\n\r\n\r\n//JSON.parse transforma para objeto "]},"metadata":{},"sourceType":"module"}